# IP
## IP Address
用来在网络中标记一台电脑的一串数字，在同一网络上是唯一的。

每个 IP 地址包括两部分：
- 网络地址
- 主机地址

## 分类
### A 类：

1 字节网络地址，3 字节主机地址，最高位必须是“0”，地址范围：1.0.0.1-126.255.255.254

可用的 A 类网络有 126 个，每个网络能容纳 1677214 个 host

一般用于互联网

### B 类：

2 字节网络地址，2 字节主机地址，最高位必须是“10”，地址范围：128.1.0.1-191.255.255.254

可用的 B 类网络有 16384 个，每个网络能容纳 65534 个 host

### C 类：

3 字节网络地址，1 字节主机地址，最高位必须是 “110”，地址范围：192.0.0.1-223.255.255.254

可用的 C 类网络有 2097152 个，每个网络能容纳 254 个 host

一般用于局域网

### D 类：

第一个字节以 “1110” 开始，它是一个专门保留的地址，地址范围：224.0.0.1-239.255.255.254

不指向特定的网络，被用于 multicast（多点广播）中多点广播地址用来一次寻址一组计算机

### E 类：

以 “1111” 开始，为将来使用保留，仅做实验和开发使用

## Gateway（网关）
网关又称网间连接器、协议连接器。默认网关在网络层上以实现网络互连，是最复杂的网络互连设备，仅用于两个高层协议不同的网络互连。

网关的结构也和路由器类似，不同的互联层。网关既可以用于广域网互连，也可以用于局域网互连。

网关实际上是一个网络通向其他网络的 IP 地址

在没有路由器的情况下，两个网络之间是不能进行 TCP/IP 通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP 协议也会根据子网掩码判定两个网络中的主机处在不同的网络里。

而要实现这两个网络之前的通信，则必须通过网关。如果网络 A 中的主机发现数据包的目的主机不再本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络 B 的网关，网络 B 的网关再转发给网络 B 的某个主机。

## Subnet mask（子网掩码）
用来指明一个 IP 地址的哪些位标识的是主机所在的子网，以及哪些标识的是主机的位掩码。

子网掩码不能单独存在，它必须结合 IP 地址一起使用。

子网掩码只有一个作用，就是将某个 IP 地址划分成网络地址和主机地址两部分。

子网掩码是一个 32 位地址，用于屏蔽 IP 地址的一部分以区分网络标识和主机标识，并说明该 IP 地址是在局域网上，还是在远程网上。

- A 类地址默认子网掩码：255.0.0.0
- B 类地址默认子网掩码：255.255.0.0
- C 类地址默认子网掩码：255.255.255.0

### 根据子网掩码分割 网络号+主机号
子网掩码连续全 1 的是网络地址，后面的是主机地址；

例子：
IP 地址：202.112.14.137

子网掩码：255.255.255.224 -> 11111111 11111111 11111111 11100000

网络号有 27 位，主机号有 5 位

网络地址 = IP 地址 & 子网掩码 -> 202.112.14.128

网络地址的主机位全部变为 1，即为广播地址 -> 202.112.14.159

网络地址 + 1 即为第一个主机地址，广播地址 - 1 即为最后一个主机地址；

由此可以看出主机地址的范围是：网络地址+1 -> 广播地址-1，所以主机的数量 = 2^二进制位数的主机 - 2（减 2 是因为主机不包括网络地址和广播地址）

所以主机数为 -> 2^5 - 2 = 30 个主机

### 根据每个网络的主机数量进行子网地址的规划和计算子网掩码
比如一个子网有 10 台主机，那么对于这个子网需要的 IP 地址是：10 + 1 + 1 + 1 = 13

注意：加的第一个 1 是指这个网络连接时所需的网关地址，接着的两个 1 分别是网络地址和广播地址

因为 13 小于 16（16=2^4），所以主机位是 4 位

而 256 - 16 = 240，所以该子网掩码为 255.255.255.240

如果一个子网有 14 台主机，不少人常犯的错误是：依然分配具有 16 个地址空间的子网，而忘记了给网关分配地址

应该是 14 + 1 + 1 + 1 = 17，分配具有 32 个地址（2^5=32）空间的子网，这是子网掩码是：255.255.255.224

### 例题 1：206.110.4.0/18 被划分为 16 个子网，每个子网掩码？
通过 /18 可以知道这个 IP 已经规定了它的网络位是 18 位，它的默认子网掩码就是：11111111 11111111 11000000 00000000

我们可以操作的位数是后面的 14 个 0，需要在这里面划分出几位作为子网的网络位，进而来划分子网；

16=2^4，说明子网网络位的位数是 4，那 14-4=10 就是子网的主机位

最终结果：11111111 11111111 11111100 00000000

### 例题 2：根据 IP 地址得出子网掩码
192.168.0.1/24

后面这个数字标示了我们网络号的位数，也就是子网掩码中前多少号为 1：/24 -> 网络号为 24 位

子网掩码：11111111 11111111 11111111 00000000 -> 255.255.255.0

172.16.10.33/27

子网掩码：11111111 11111111 11111111 11100000 -> 255.255.255.224



































